# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Введение

Перед выполнением задания вы можете ознакомиться с
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/master/additional/README.md).

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде
- Склады и автомобильные дороги для логистической компании
- Генеалогические деревья
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
- Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

---

## Решение к Задаче 1

> - Электронные чеки в json виде

Документо-ориентированые БД, пример MongoDB, использует JSON-подобные документы и схему базы данных.

> - Склады и автомобильные дороги для логистической компании

Графовые БД, пример Neo4j, ArangoDB, HyperGraphDB, OrientDB. Графы используются в геоинформационных системах (ГИС), логистике, социальных сетях, магазинах и других сферах жизни.

> - Генеалогические деревья

Сетевые БД, пример IDS, хранятся и обрабатываются метаданные о записях и их взаимоотношениях.

> - Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутентификации

СУБД ключ-значение, пример Memcached, позволяет кэшировать данные в оперативной памяти ввиде хеш-таблиц

> - Отношения клиент-покупка для интернет-магазина

Реляционные СУБД, пример Postgres, MySQL. Позволяет образовывать множество связей и отношений с БД других сущностей посредством внешних ключей.

---

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
- Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

---

## Решение к Задаче 2

> - Данные записываются на все узлы с задержкой до часа (асинхронная запись)

CAP: АР  
PACELC: PА-EC

> - При сетевых сбоях, система может разделиться на 2 раздельных кластера

CAP: AP  
PACELC: PA-EL

> - Система может не прислать корректный ответ или сбросить соединение

CAP: CP  
PACELC: PC-EL

---

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

---

## Решение к Задаче 3

> Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

Принципы BASE и ACID не могут сочетаться т. к. являются диаметрально противоположными по части согласованности. Принципы BASE значительно слабее гарантий ACID, и между ними нет прямого соответствия. Значения в BASE-хранилище до­ступны (потому что это является основой масштабирования), но это не предлагает гарантированной согласованности реплик при запи­си, как в ACID.

---

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/).
Что это за система? Какие минусы выбора данной системы?

---

## Решение к Задаче 4

> Вам дали задачу написать системное решение, основой которого бы послужили:
>
> - фиксация некоторых значений с временем жизни
> - реакция на истечение таймаута  
> Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/).
> Что это за система? Какие минусы выбора данной системы?

Redis это хранилище типа ключ-значение (key-value) с механизмом издатель-подписчик (Pub/Sub) и механизмом устанавливающим срок действия ключа (TTL).

Вот некоторые недостатки:  

- Redis использует дамп памяти для создания моментального снимка сохраняемости, но для этого требуется некоторая настройка ядра Linux, чтобы избежать снижения производительности во время разветвления серверного процесса Redis.
- Проблемы с фрагментацией памяти. Запись и удаление огромных объемов данных может привести к снижению производительности.
- Управление TTL требует дисциплины на уровне приложений. Время от времени сервер Redis может быть переполнен устаревшими данными, потому что некоторые ключи не имеют TTL.

Некоторые недостатки при использовании архитектуры master-slave

- Для репликации будет только один ведущий сервер с несколькими подчиненными устройствами.
- Если Master выходит из строя, вся архитектура подвержена SPOF (единой точке отказа).
- Нужен Sentinel для мониторинга Master в случае сбоя или завершения работы или переназначить master вручную.
- Sentinel нужно запустить на каждом сервере, а также нужен отдельный процесс для мониторинга sentinel, т. е. для его перезапуска в случае, если sentinel не работает.
- Все записи отправляются на главный узел, что создает большую нагрузку на главный узел.

---

### Как cдавать задание

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.
